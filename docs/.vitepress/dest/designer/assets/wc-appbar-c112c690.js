const _=(e,t,s)=>Math.max(t,Math.min(e,s));function $(e,t){const s=e.indexOf(t);~s&&e.splice(s,1)}function u(e,t,s){const i=Object.assign(document.createElement(e),t);return s&&i.replaceChildren(...s),i}function Y(e){for(;e=e.parentElement;){const{overflowY:t}=getComputedStyle(e);if(t==="auto"||t==="scroll")return e}return e||window}function z(e,t=200){let s=0;return{looping:!1,st:0,r:0,loop(){if(!this.looping)return;const i=this.r=Math.min((+new Date-this.st)/t,1);if(e(i),i>=1)return this.pause();s=requestAnimationFrame(()=>this.loop())},resume(){this.st=+new Date,this.looping=!0,this.loop()},pause(){this.looping=!1,cancelAnimationFrame(s)}}}const T=[],D=Promise.resolve();function L(e){T.includes(e)||(T.push(e),D.then(()=>{e(),$(T,e)}))}var I=Object.defineProperty,Z=(e,t,s)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,M=(e,t,s)=>(Z(e,typeof t!="symbol"?t+"":t,s),s),A=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},n=(e,t,s)=>(A(e,t,"read from private field"),s?s.call(e):t.get(e)),h=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},a=(e,t,s,i)=>(A(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),r,E,b,w,H,W,c,C,f,O,S,R,d;const v=Symbol("SIZE"),p={minh:56,maxh:0,floating:!1,pinned:!1,snap:!1,elevation:"0 4px 8px -2px #00000020"},q=e=>e.replace(/(.)([A-Z])/g,(t,s,i)=>s+"-"+i.toLowerCase());class j extends HTMLElement{constructor(){super(),h(this,S),M(this,"props",{...p}),h(this,r,void 0),h(this,E,void 0),h(this,b,void 0),h(this,w,void 0),M(this,H,[0,0]),M(this,"offset",0),h(this,W,0),h(this,c,0),h(this,C,void 0),h(this,f,void 0),h(this,O,0),h(this,d,()=>{var t;const{props:s,_maxh:i}=this,o=n(this,S,R),{floating:y,snap:P}=s,g=n(this,W),l=a(this,W,-n(this,O)+a(this,O,o));(g>0&&l<0||g<0&&l>0)&&a(this,c,0),a(this,c,n(this,c)+l),this.offset=y?_(this.offset-l,0,i):Math.max(0,i-o),y&&P&&Math.abs(n(this,c))>10&&((t=n(this,f))==null||t.pause(),clearTimeout(n(this,C)),a(this,C,setTimeout(()=>{const m=this.offset,x=l<0?i:Math.max(i-o,0);a(this,f,z(()=>{const{r:k}=n(this,f);this.offset=m+(x-m)*k,L(this.render)})),n(this,f).resume()},50))),L(this.render)}),M(this,"render",()=>{const{props:t,h:s,y:i,style:o,offset:y,shrinkOffset:P,shrinkH:g,minh:l,_maxh:m}=this,x=n(this,b)[v][1];Object.assign(n(this,E).style,{position:"fixed",width:`${this[v][0]}px`,height:`${s+x}px`,boxShadow:t.pinned||t.floating&&this.offset!=0?t.elevation:"",transform:`translateY(${i}px)`,zIndex:1,background:"var(--wc-appbar-bg)"});const k=`:host { position: relative; display: block; height: ${m+x}px; }`;n(this,w).innerHTML!=k&&(n(this,w).innerHTML=k),o.setProperty("--wc-appbar-minh",l+""),o.setProperty("--wc-appbar-maxh",m+""),o.setProperty("--wc-appbar-offset",y+""),o.setProperty("--wc-appbar-shrink-offset",P+""),o.setProperty("--wc-appbar-shrink-h",g+""),o.setProperty("--wc-appbar-h",s+""),o.setProperty("--wc-appbar-y",i+""),this.dispatchEvent(new Event("update"))}),this.attachShadow({mode:"open"})}static get observedAttributes(){return Object.keys(p).map(q)}get _maxh(){return Math.max(this.minh,this.maxh)}get shrinkOffset(){return this._maxh-this.offset}get shrinkH(){return this._maxh-this.h}get y(){return this.pinned?0:Math.min(this.offset-this.minh,0)}get h(){return _(this.offset,this.minh,this._maxh)}connectedCallback(){a(this,r,Y(this)),n(this,r).addEventListener("scroll",n(this,d),{passive:!0}),this.shadowRoot.replaceChildren(a(this,E,u("div",null,[u("slot"),a(this,b,u("div",{[v]:[0,0],style:"position: absolute; bottom: 0; width: 100%;"},[u("slot",{name:"bottom"})]))])),a(this,w,u("style")));const t=new ResizeObserver(s=>{s.forEach(i=>{i.target[v]=[i.contentRect.width,i.contentRect.height]}),n(this,d).call(this)});t.observe(this),t.observe(n(this,b)),this.offset=this._maxh}disconnectedCallback(){n(this,r).removeEventListener("scroll",n(this,d)),this.shadowRoot.replaceChildren()}attributeChangedCallback(t,s,i){typeof p[t]=="boolean"?i=i!=="false":i=p[t].constructor(i),this.props[t]=i,this.isConnected&&L(n(this,d))}}H=v,r=new WeakMap,E=new WeakMap,b=new WeakMap,w=new WeakMap,W=new WeakMap,c=new WeakMap,C=new WeakMap,f=new WeakMap,O=new WeakMap,S=new WeakSet,R=function(){return n(this,r)instanceof HTMLElement?n(this,r).scrollTop:n(this,r).scrollY},d=new WeakMap,Object.keys(p).forEach(e=>{Object.defineProperty(j.prototype,e,{get(){var t;return(t=this.props[e])!=null?t:p[e]},set(t){this.setAttribute(e,typeof p[e]=="boolean"?t??p[e]:t)}})}),customElements.define("wc-appbar",j);export{j as AppbarElement};
