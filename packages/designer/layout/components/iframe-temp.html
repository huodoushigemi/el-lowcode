<!DOCTYPE html>
<html class="sl-theme-dark mdui-theme-auto dark">
  <head>
    <style>
      html, body, .Page { width: 100%; height: 100%; }
      body { margin: 0; }
      .Page { overflow: auto; }
      * { box-sizing: border-box; }
    </style>

    <!-- 共享 Vue 内存，以便实现数据响应 -->
    <script>
      if (window.parent) window.Vue = window.parent.Vue
    </script>



    <!-- 解决 iframe 不支持鼠标事件的问题 -->
    <script type="module">
      import { pick } from '@el-lowcode/utils'

      if (window.parent) {
        document.addEventListener('wheel', e => {
          e.preventDefault()
          e.stopPropagation()
          
          const rect = frameElement.getBoundingClientRect()
          const x = e.x + rect.x, y = e.y + rect.y

          const event = new WheelEvent(e.type, {
            ...pick(e, [
              'deltaMode', 'deltaX', 'deltaY', 'deltaZ',
              'button', 'buttons',
              'screenX', 'screenY',
              'detail', 'which',
              'altKey', 'ctrlKey', 'metaKey', 'shiftKey',
              // 'modifierAltGraph', 'modifierCapsLock', 'modifierFn', 'modifierFnLock', 'modifierHyper', 'modifierNumLock', 'modifierScrollLock', 'modifierSuper', 'modifierSymbol', 'modifierSymbolLock',
              'bubbles', 'cancelable', 'composed'
            ]),
            // view: parent,
            clientX: x, clientY: y,
          })
          
          frameElement.dispatchEvent(event)
        }, { passive: false, capture: true })

        document.addEventListener('mousedown', e => {
          if (e.button != 1) return
          e.preventDefault()
          e.stopPropagation()
          frameElement.dispatchEvent(new parent.MouseEvent(e.type, e))
        }, { passive: false })
      }
    </script>

    
  
    <!-- 渲染 JSON -->
    <script type="module">
      import { createApp, h } from 'vue'
      import ElLowcode, { ConfigProvider } from 'el-lowcode'
      import DragBox from './drag-box2.vue'

      const app = createApp({
        provide: {
          designerCtx
        },
        render: () => [
          h(ConfigProvider, designerCtx.root, () => [
            h(DragBox, { el: designerCtx.root })
          ])
        ]
      })

      app.use(ElLowcode)
      app.mount(document.body)
    </script>
  </head>
  <body>
    <!--  -->
  </body>
</html>